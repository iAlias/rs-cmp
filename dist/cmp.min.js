"use strict";var RSCMP=(()=>{var D=Object.defineProperty,E=Object.defineProperties;var z=Object.getOwnPropertyDescriptors;var A=Object.getOwnPropertySymbols;var R=Object.prototype.hasOwnProperty,$=Object.prototype.propertyIsEnumerable;var I=(c,e,t)=>e in c?D(c,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):c[e]=t,p=(c,e)=>{for(var t in e||(e={}))R.call(e,t)&&I(c,t,e[t]);if(A)for(var t of A(e))$.call(e,t)&&I(c,t,e[t]);return c},M=(c,e)=>E(c,z(e));var O=(c,e)=>()=>(e||c((e={exports:{}}).exports,e),e.exports);var m=(c,e,t)=>new Promise((n,o)=>{var i=s=>{try{a(t.next(s))}catch(r){o(r)}},l=s=>{try{a(t.throw(s))}catch(r){o(r)}},a=s=>s.done?n(s.value):Promise.resolve(s.value).then(i,l);a((t=t.apply(c,e)).next())});var B=O((N,h)=>{var f="rs-cmp-consent",y="rs-cmp-consent";function b(){let c=document.querySelector("script[nonce]");if(c&&c.nonce)return c.nonce;let e=document.querySelector('meta[property="csp-nonce"]');return e?e.getAttribute("content"):null}var k=class{saveConsent(e){let t=JSON.stringify(e);try{localStorage.setItem(f,t)}catch(n){console.warn("[RS-CMP] Failed to save to localStorage:",n)}this.setCookie(y,"1",31536e3)}getConsent(){try{let t=localStorage.getItem(f);if(t){let n=JSON.parse(t),o=new Date(n.timestamp);return(Date.now()-o.getTime())/(1e3*60*60*24)>365?(console.log("[RS-CMP] Consent expired (> 12 months), clearing..."),this.clearConsent(),null):n}}catch(t){console.warn("[RS-CMP] Failed to read from localStorage:",t)}return this.getCookie(y)==="1"&&console.warn("[RS-CMP] Cookie found but localStorage unavailable - cannot retrieve full consent state"),null}clearConsent(){try{localStorage.removeItem(f)}catch(e){console.warn("[RS-CMP] Failed to clear localStorage:",e)}this.deleteCookie(y)}setCookie(e,t,n){let o=window.location.protocol==="https:"?"; Secure":"";document.cookie=`${e}=${encodeURIComponent(t)}; max-age=${n}; path=/; SameSite=Lax${o}`}getCookie(e){let t=e+"=",n=document.cookie.split(";");for(let o=0;o<n.length;o++){let i=n[o];for(;i.charAt(0)===" ";)i=i.substring(1);if(i.indexOf(t)===0)return decodeURIComponent(i.substring(t.length))}return null}deleteCookie(e){document.cookie=`${e}=; max-age=0; path=/`}},S=class{constructor(e){this.eventHandlers=new Map,this.storage=e}setConsent(e,t){let n={categories:e,timestamp:new Date().toISOString(),version:t};this.storage.saveConsent(n),this.pushToDataLayer(e),this.emit("consentUpdated",e)}pushToDataLayer(e){window.dataLayer=window.dataLayer||[],window.dataLayer.push({event:"cookie_consent_update",cookie_consent_analytics:e.analytics,cookie_consent_marketing:e.marketing,cookie_consent_preferences:e.preferences,cookie_consent_necessary:e.necessary,consent_timestamp:new Date().toISOString()})}getConsent(){let e=this.storage.getConsent();return e?e.categories:null}acceptAll(e){this.setConsent({necessary:!0,analytics:!0,marketing:!0,preferences:!0},e)}rejectAll(e){this.setConsent({necessary:!0,analytics:!1,marketing:!1,preferences:!1},e)}hasConsent(e){let t=this.getConsent();return t?t[e]:!1}on(e,t){this.eventHandlers.has(e)||this.eventHandlers.set(e,[]),this.eventHandlers.get(e).push(t)}emit(e,t){let n=this.eventHandlers.get(e);n&&n.forEach(o=>o(t))}},C=class{constructor(e){this.consentManager=e,this.blockedScripts=[],this.scriptObserver=null}detectCategory(e){let t=(e||"").toLowerCase();return t?t.indexOf("gtag(")!==-1||t.indexOf("google-analytics")!==-1||t.indexOf("analytics.js")!==-1||t.indexOf("googletagmanager.com/gtag")!==-1||t.indexOf("hotjar")!==-1||t.indexOf("mixpanel")!==-1||t.indexOf("amplitude")!==-1||t.indexOf("clarity.ms")!==-1?"analytics":t.indexOf("connect.facebook.net")!==-1||t.indexOf("fbq(")!==-1||t.indexOf("tiktok.com")!==-1||t.indexOf("analytics.tiktok.com")!==-1||t.indexOf("ads/")!==-1||t.indexOf("doubleclick.net")!==-1||t.indexOf("googleadservices.com")!==-1?"marketing":null:null}blockScripts(){document.querySelectorAll("script[data-category]").forEach(t=>{t.getAttribute("data-category")!=="necessary"&&(t.getAttribute("type")!=="text/plain"&&(t.setAttribute("data-original-type",t.getAttribute("type")||"text/javascript"),t.setAttribute("type","text/plain")),this.blockedScripts.push(t))}),this.scanAndBlockCommonScripts(),this.startScriptObserver()}unblockScripts(e){this.blockedScripts.forEach(t=>{let n=t.getAttribute("data-category");if(n&&e[n]){let o=t.getAttribute("data-original-type")||"text/javascript",i=document.createElement("script");Array.from(t.attributes).forEach(l=>{l.name==="type"?i.setAttribute("type",o):l.name==="data-original-type"||i.setAttribute(l.name,l.value)}),t.textContent&&(i.textContent=t.textContent),t.parentNode&&t.parentNode.replaceChild(i,t)}}),this.unblockCommonScripts(e)}scanAndBlockCommonScripts(){document.querySelectorAll("script").forEach(t=>{if(t.getAttribute("data-category"))return;let n=t.src||"",o=t.textContent||"",i=this.detectCategory(n+" "+o);i&&i!=="necessary"&&(t.setAttribute("data-category",i),t.setAttribute("data-original-type",t.type||"text/javascript"),t.type="text/plain",this.blockedScripts.push(t))})}unblockCommonScripts(e){e.analytics&&typeof window.gtag=="function"&&window.gtag("consent","update",{analytics_storage:"granted"}),e.marketing&&typeof window.fbq=="function"&&window.fbq("consent","grant")}startScriptObserver(){if(typeof MutationObserver=="undefined"){console.warn("[RS-CMP] MutationObserver not available, dynamic script blocking disabled");return}this.scriptObserver||(this.scriptObserver=new MutationObserver(e=>{e.forEach(t=>{t.addedNodes.forEach(n=>{n.nodeName==="SCRIPT"&&this.processNewScript(n),n.querySelectorAll&&n.querySelectorAll("script").forEach(i=>this.processNewScript(i))})})}),this.scriptObserver.observe(document.documentElement,{childList:!0,subtree:!0}),console.log("[RS-CMP] Script observer started for dynamic script blocking"))}processNewScript(e){if(e.getAttribute("data-rs-cmp-processed"))return;e.setAttribute("data-rs-cmp-processed","true");let t=e.getAttribute("data-category");if(!t){let n=e.src||"",o=e.textContent||"";t=this.detectCategory(n+" "+o)}if(t&&t!=="necessary"){let n=this.consentManager.getConsent();(!n||!n[t])&&(e.setAttribute("data-category",t),e.setAttribute("data-original-type",e.type||"text/javascript"),e.type="text/plain",this.blockedScripts.push(e),console.log(`[RS-CMP] Blocked dynamically added ${t} script`))}}stopScriptObserver(){this.scriptObserver&&(this.scriptObserver.disconnect(),this.scriptObserver=null,console.log("[RS-CMP] Script observer stopped"))}getBlockedScriptsByCategory(e){return!this.blockedScripts||this.blockedScripts.length===0?[]:this.blockedScripts.filter(t=>t.getAttribute("data-category")===e)}},x=class{constructor(e){this.consentManager=e,this.initializeDefaultConsent()}initializeDefaultConsent(){typeof window.gtag=="function"&&window.gtag("consent","default",{ad_storage:"denied",ad_user_data:"denied",ad_personalization:"denied",analytics_storage:"denied",functionality_storage:"denied",personalization_storage:"denied",security_storage:"granted"})}update(e){typeof window.gtag!="function"&&this.initializeGtag(),typeof window.gtag=="function"&&window.gtag("consent","update",{ad_storage:e.marketing?"granted":"denied",ad_user_data:e.marketing?"granted":"denied",ad_personalization:e.marketing?"granted":"denied",analytics_storage:e.analytics?"granted":"denied",functionality_storage:e.preferences?"granted":"denied",personalization_storage:e.preferences?"granted":"denied"})}initializeGtag(){typeof window.gtag=="undefined"&&(window.dataLayer=window.dataLayer||[],window.gtag=function(){window.dataLayer.push(arguments)},window.gtag("js",new Date))}},v=class{constructor(e,t,n){this.consentManager=e,this.cookieScanner=t,this.scriptBlocker=n,this.bannerElement=null,this.config=null}show(e){if(this.config=e,this.bannerElement)return;let t=this.detectLanguage(),n=e.translations[t]||e.translations.en||e.translations[Object.keys(e.translations)[0]];this.bannerElement=this.createBanner(e,n),document.body.appendChild(this.bannerElement),this.consentManager.emit("bannerShown",{})}hide(){this.bannerElement&&(this.bannerElement.remove(),this.bannerElement=null,this.consentManager.emit("bannerClosed",{}))}createBanner(e,t){let n=document.createElement("div");return n.id="rs-cmp-banner",n.setAttribute("role","dialog"),n.setAttribute("aria-label",t.title),n.setAttribute("aria-modal","true"),this.applyStyles(n,e),n.innerHTML=`
      <div class="rs-cmp-content">
        ${e.banner.showLogo&&e.banner.logoUrl?`<img src="${e.banner.logoUrl}" alt="Logo" class="rs-cmp-logo" />`:""}
        <h2 class="rs-cmp-title">${this.escapeHtml(t.title)}</h2>
        <p class="rs-cmp-description">${this.escapeHtml(t.description)}</p>
        <div class="rs-cmp-buttons">
          <button class="rs-cmp-btn rs-cmp-btn-accept" id="rs-cmp-accept-all">
            ${this.escapeHtml(t.acceptAll)}
          </button>
          <button class="rs-cmp-btn rs-cmp-btn-reject" id="rs-cmp-reject-all">
            ${this.escapeHtml(t.rejectAll)}
          </button>
          <button class="rs-cmp-btn rs-cmp-btn-customize" id="rs-cmp-customize">
            ${this.escapeHtml(t.customize)}
          </button>
        </div>
      </div>
    `,this.attachEventListeners(n),n}applyStyles(e,t){let{position:n,layout:o,primaryColor:i,backgroundColor:l,textColor:a,buttonTextColor:s}=t.banner;if(!document.getElementById("rs-cmp-styles")){let r=document.createElement("style");r.id="rs-cmp-styles",r.textContent=`
        #rs-cmp-banner {
          position: fixed;
          z-index: 999999;
          font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Helvetica, Arial, sans-serif;
          background: ${l};
          color: ${a};
          box-shadow: 0 -2px 16px rgba(0, 0, 0, 0.1);
          border-top: 1px solid rgba(0, 0, 0, 0.08);
          ${this.getPositionStyles(n,o)}
        }
        
        .rs-cmp-content {
          padding: 20px 32px;
          max-width: 1200px;
          margin: 0 auto;
        }
        
        .rs-cmp-logo {
          max-width: 150px;
          margin-bottom: 16px;
        }
        
        .rs-cmp-title {
          margin: 0 0 8px 0;
          font-size: 16px;
          font-weight: 600;
          line-height: 1.4;
        }
        
        .rs-cmp-description {
          margin: 0 0 16px 0;
          font-size: 13px;
          line-height: 1.6;
          opacity: 0.85;
          max-width: 800px;
        }
        
        .rs-cmp-buttons {
          display: flex;
          gap: 10px;
          flex-wrap: wrap;
          align-items: center;
        }
        
        .rs-cmp-btn {
          padding: 10px 20px;
          border: none;
          border-radius: 4px;
          font-size: 13px;
          font-weight: 500;
          cursor: pointer;
          transition: all 0.2s ease;
          white-space: nowrap;
        }
        
        .rs-cmp-btn:hover {
          transform: translateY(-1px);
          box-shadow: 0 2px 8px rgba(0, 0, 0, 0.15);
        }
        
        .rs-cmp-btn:active {
          transform: translateY(0);
        }
        
        .rs-cmp-btn:focus {
          outline: 2px solid ${i};
          outline-offset: 2px;
        }
        
        .rs-cmp-btn-accept {
          background: ${i};
          color: ${s};
        }
        
        .rs-cmp-btn-reject {
          background: #f5f5f5;
          color: ${a};
          border: 1px solid #e0e0e0;
        }
        
        .rs-cmp-btn-reject:hover {
          background: #ebebeb;
        }
        
        .rs-cmp-btn-customize {
          background: transparent;
          color: ${i};
          text-decoration: none;
          padding: 10px 16px;
        }
        
        .rs-cmp-btn-customize:hover {
          text-decoration: underline;
          box-shadow: none;
          transform: none;
        }
        
        @media (max-width: 768px) {
          #rs-cmp-banner {
            left: 0 !important;
            right: 0 !important;
            width: 100% !important;
          }
          
          .rs-cmp-content {
            padding: 16px 20px;
          }
          
          .rs-cmp-buttons {
            flex-direction: column;
            gap: 8px;
          }
          
          .rs-cmp-btn {
            width: 100%;
          }
        }
      `;let d=b();d&&r.setAttribute("nonce",d),document.head.appendChild(r)}}getPositionStyles(e,t){return t==="modal"||e==="center"?`
        top: 50%;
        left: 50%;
        transform: translate(-50%, -50%);
        max-width: 600px;
        border-radius: 12px;
      `:e==="bottom"?`
        bottom: 0;
        left: 0;
        right: 0;
        border-radius: 0;
      `:`
        top: 0;
        left: 0;
        right: 0;
        border-radius: 0;
      `}attachEventListeners(e){let t=e.querySelector("#rs-cmp-accept-all"),n=e.querySelector("#rs-cmp-reject-all"),o=e.querySelector("#rs-cmp-customize");t&&t.addEventListener("click",()=>{this.consentManager.acceptAll(this.config?this.config.policyVersion:"1.0"),this.hide()}),n&&n.addEventListener("click",()=>{this.consentManager.rejectAll(this.config?this.config.policyVersion:"1.0"),this.hide()}),o&&o.addEventListener("click",()=>{this.showCustomizeModal()})}showCustomizeModal(){if(!this.config)return;this.cookieScanner.performInitialScan();let e=this.detectLanguage(),t=this.config.translations[e]||this.config.translations.en||this.config.translations[Object.keys(this.config.translations)[0]],n=this.consentManager.getConsent(),o=document.createElement("div");if(o.id="rs-cmp-customize-modal",o.setAttribute("role","dialog"),o.setAttribute("aria-label",t.customize),o.innerHTML=`
      <div class="rs-cmp-modal-overlay"></div>
      <div class="rs-cmp-modal-content">
        <h2>${this.escapeHtml(t.customize)}</h2>
        <div class="rs-cmp-categories">
          ${this.config.categories.map(s=>{let r=s.required||n&&n[s.id]||!1;return`
            <div class="rs-cmp-category">
              <div class="rs-cmp-category-header">
                <label>
                  <input 
                    type="checkbox" 
                    name="${s.id}" 
                    ${s.required?"checked disabled":""}
                    ${r?"checked":""}
                  />
                  <div>
                    <strong>${this.escapeHtml(t.categories[s.id]?t.categories[s.id].name:s.name)}</strong>
                    <p>${this.escapeHtml(t.categories[s.id]?t.categories[s.id].description:s.description)}</p>
                  </div>
                </label>
                <button 
                  class="rs-cmp-toggle-details" 
                  onclick="this.parentElement.nextElementSibling.classList.toggle('rs-cmp-hidden')"
                  aria-label="Show details"
                >
                  \u25BC
                </button>
              </div>
              ${this.getServicesForCategory(s.id)}
            </div>
          `}).join("")}
        </div>
        <div class="rs-cmp-modal-buttons">
          <button class="rs-cmp-btn rs-cmp-btn-accept" id="rs-cmp-save-preferences">
            ${this.escapeHtml(t.save)}
          </button>
          <button class="rs-cmp-btn rs-cmp-btn-customize" id="rs-cmp-close-modal">
            ${this.escapeHtml(t.close)}
          </button>
        </div>
      </div>
    `,!document.getElementById("rs-cmp-modal-styles")){let s=document.createElement("style");s.id="rs-cmp-modal-styles",s.textContent=`
        #rs-cmp-customize-modal {
          position: fixed;
          top: 0;
          left: 0;
          right: 0;
          bottom: 0;
          z-index: 1000000;
        }
        
        .rs-cmp-modal-overlay {
          position: absolute;
          top: 0;
          left: 0;
          right: 0;
          bottom: 0;
          background: rgba(0, 0, 0, 0.6);
          backdrop-filter: blur(2px);
        }
        
        .rs-cmp-modal-content {
          position: absolute;
          top: 50%;
          left: 50%;
          transform: translate(-50%, -50%);
          background: linear-gradient(to bottom, #ffffff, #f8f9fa);
          padding: 32px;
          border-radius: 16px;
          min-width: 50vw;
          max-width: 800px;
          max-height: 85vh;
          overflow-y: auto;
          box-shadow: 0 20px 60px rgba(0, 0, 0, 0.3), 0 0 1px rgba(0, 0, 0, 0.1);
          border: 1px solid rgba(255, 255, 255, 0.8);
          animation: rs-cmp-modal-appear 0.3s ease-out;
        }
        
        @keyframes rs-cmp-modal-appear {
          from {
            opacity: 0;
            transform: translate(-50%, -48%) scale(0.95);
          }
          to {
            opacity: 1;
            transform: translate(-50%, -50%) scale(1);
          }
        }
        
        .rs-cmp-modal-content h2 {
          color: #1a202c;
          font-size: 24px;
          font-weight: 700;
          margin: 0 0 8px 0;
          letter-spacing: -0.5px;
        }
        
        .rs-cmp-categories {
          margin: 24px 0;
        }
        
        .rs-cmp-category {
          padding: 20px;
          background: white;
          border: 2px solid #e2e8f0;
          border-radius: 12px;
          margin-bottom: 16px;
          transition: all 0.2s ease;
        }
        
        .rs-cmp-category:hover {
          border-color: #cbd5e0;
          box-shadow: 0 4px 12px rgba(0, 0, 0, 0.08);
          transform: translateY(-2px);
        }
        
        .rs-cmp-category label {
          display: flex;
          gap: 16px;
          cursor: pointer;
          align-items: flex-start;
        }
        
        .rs-cmp-category input[type="checkbox"] {
          margin-top: 4px;
          width: 20px;
          height: 20px;
          cursor: pointer;
          accent-color: #2563eb;
        }
        
        .rs-cmp-category input[type="checkbox"]:disabled {
          cursor: not-allowed;
          opacity: 0.5;
        }
        
        .rs-cmp-category strong {
          color: #2d3748;
          font-size: 16px;
          font-weight: 600;
        }
        
        .rs-cmp-category p {
          margin: 6px 0 0 0;
          font-size: 14px;
          line-height: 1.6;
          color: #4a5568;
        }
        
        .rs-cmp-hidden {
          display: none !important;
        }
        
        .rs-cmp-category-header {
          display: flex;
          justify-content: space-between;
          align-items: flex-start;
        }
        
        .rs-cmp-toggle-details {
          background: transparent;
          border: none;
          cursor: pointer;
          font-size: 12px;
          padding: 4px 8px;
        }
        
        .rs-cmp-category-services {
          margin-top: 12px;
          padding: 12px;
          background: #f5f5f5;
          border-radius: 4px;
          font-size: 12px;
        }
        
        .rs-cmp-services-table {
          width: 100%;
          border-collapse: collapse;
        }
        
        .rs-cmp-services-table th,
        .rs-cmp-services-table td {
          padding: 6px 8px;
          text-align: left;
          border-bottom: 1px solid #ddd;
        }
        
        .rs-cmp-services-table th {
          font-weight: 600;
          background: #e9e9e9;
        }
        
        .rs-cmp-modal-buttons {
          display: flex;
          gap: 12px;
          margin-top: 24px;
        }
        
        .rs-cmp-modal-buttons button {
          flex: 1;
          padding: 14px 28px;
          font-size: 15px;
          font-weight: 600;
          border-radius: 10px;
          border: none;
          cursor: pointer;
          transition: all 0.2s ease;
        }
        
        .rs-cmp-modal-buttons button:first-child {
          background: linear-gradient(135deg, #2563eb 0%, #1d4ed8 100%);
          color: white;
          box-shadow: 0 4px 12px rgba(37, 99, 235, 0.3);
        }
        
        .rs-cmp-modal-buttons button:first-child:hover {
          background: linear-gradient(135deg, #1d4ed8 0%, #1e40af 100%);
          box-shadow: 0 6px 16px rgba(37, 99, 235, 0.4);
          transform: translateY(-2px);
        }
        
        .rs-cmp-modal-buttons button:last-child {
          background: #f1f5f9;
          color: #475569;
          border: 2px solid #e2e8f0;
        }
        
        .rs-cmp-modal-buttons button:last-child:hover {
          background: #e2e8f0;
          border-color: #cbd5e0;
        }
        
        @media (max-width: 768px) {
          .rs-cmp-modal-content {
            min-width: 90vw;
            max-width: 90vw;
            padding: 24px;
          }
          
          .rs-cmp-modal-buttons {
            flex-direction: column;
          }
        }
        
        @media (prefers-reduced-motion: reduce) {
          .rs-cmp-modal-content {
            animation: none;
          }
          
          .rs-cmp-category:hover {
            transform: none;
          }
          
          .rs-cmp-modal-buttons button:hover {
            transform: none;
          }
        }
      `;let r=b();r&&s.setAttribute("nonce",r),document.head.appendChild(s)}document.body.appendChild(o);let i=o.querySelector("#rs-cmp-save-preferences");i&&i.addEventListener("click",()=>{let s=o.querySelector('input[name="analytics"]'),r=o.querySelector('input[name="marketing"]'),d=o.querySelector('input[name="preferences"]'),g={necessary:!0,analytics:s?s.checked:!1,marketing:r?r.checked:!1,preferences:d?d.checked:!1};this.consentManager.setConsent(g,this.config?this.config.policyVersion:"1.0"),o.remove(),this.hide()});let l=o.querySelector("#rs-cmp-close-modal");l&&l.addEventListener("click",()=>{o.remove()});let a=o.querySelector(".rs-cmp-modal-overlay");a&&a.addEventListener("click",()=>{o.remove()})}getServicesForCategory(e){var a,s;let t=((a=this.cookieScanner)==null?void 0:a.getCookiesByCategory(e))||[],n=((s=this.scriptBlocker)==null?void 0:s.getBlockedScriptsByCategory(e))||[];if(t.length===0&&n.length===0)return`
        <div class="rs-cmp-category-services rs-cmp-hidden">
          <p class="rs-cmp-no-cookies">No cookies or scripts detected for this category.</p>
        </div>
      `;let o=this.groupCookiesIntoServices(t),i=this.getServicesFromBlockedScripts(n),l=[...o];return i.forEach(r=>{l.some(g=>g.provider===r.provider)||l.push(r)}),`
      <div class="rs-cmp-category-services rs-cmp-hidden">
        <table class="rs-cmp-services-table">
          <thead>
            <tr>
              <th>Cookie Name</th>
              <th>Provider</th>
              <th>Origin</th>
            </tr>
          </thead>
          <tbody>
            ${l.map(r=>`
              <tr>
                <td>${this.escapeHtml(r.name)}</td>
                <td>${this.escapeHtml(r.provider)}</td>
                <td>${this.escapeHtml(r.origin)}</td>
              </tr>
            `).join("")}
          </tbody>
        </table>
      </div>
    `}groupCookiesIntoServices(e){let t=[{pattern:/^_g(a|id|at|ac)/,provider:"Google Analytics"},{pattern:/^_gcl_au$/,provider:"Google Tag Manager"},{pattern:/^_gcl/,provider:"Google Ads"},{pattern:/^_dc_gtm_/,provider:"Google Tag Manager"},{pattern:/^(AEC|ADS_VISITOR_ID|ps_l)$/,provider:"Google Ads"},{pattern:/^(APISID|SAPISID|HSID|SID|SSID|SIDCC|__Secure-3PAPISID|__Secure-3PSID|__Secure-3PSIDTS|__Secure-BUCKET|Secure-ENID|SEARCH_SAMESITE)$/,provider:"Google"},{pattern:/^NID$/,provider:"Google"},{pattern:/^S$/,provider:"Generic Marketing"},{pattern:/^(_fbp|_fbc|_fr|^fr|^wd)$/,provider:"Meta (Facebook)"},{pattern:/^_hj/,provider:"Hotjar"},{pattern:/^(_clck|_clsk|CLID|SM)$/,provider:"Microsoft Clarity"},{pattern:/^(ai_session|ai_user)$/,provider:"Azure Application Insights"},{pattern:/^(MUID|ANONCHK|SRM_B)$/,provider:"Microsoft"},{pattern:/^(_ttp|__ttd)/,provider:"TikTok"},{pattern:/^(\.ASPXANONYMOUS|ASP\.NET_ID|ASP.NET_SessionId)/,provider:"ASP.NET"},{pattern:/^(\.?ARRAffinity|ARRAffinitySameSite)/,provider:"Azure"},{pattern:/^(cityidc_|CNC_PSIC)/,provider:"Store Selection"},{pattern:/(session|SESS)/i,provider:"Session Management"},{pattern:/(csrf|XSRF)/i,provider:"Security"},{pattern:/^rs-cmp-consent$/,provider:"Consent Management"}];return e.map(n=>{let o="Unknown";for(let{pattern:l,provider:a}of t)if(l.test(n.name)){o=a;break}o==="Unknown"&&(o=n.isFirstParty?"First-party":"Third-party");let i=n.isFirstParty?"First-party":"Third-party";return{name:n.name,provider:o,origin:i}})}getServicesFromBlockedScripts(e){let t=[],n=new Set,o=[{patterns:["googleadservices.com","googlesyndication.com"],name:"Google Ads"},{patterns:["google-analytics.com","analytics.js"],name:"Google Analytics"},{patterns:["googletagmanager.com"],name:"Google Tag Manager"},{patterns:["doubleclick.net"],name:"DoubleClick"},{patterns:["connect.facebook.net","fbq("],name:"Meta (Facebook)"},{patterns:["hotjar.com"],name:"Hotjar"},{patterns:["clarity.ms"],name:"Microsoft Clarity"},{patterns:["tiktok.com"],name:"TikTok"}];return e.forEach(i=>{let l=(i.src||"").toLowerCase(),a=null,s="(Script blocked)";if(l){for(let{patterns:r,name:d}of o)if(r.some(g=>l.includes(g))){a=d;break}if(!a)try{a=new URL(i.src).hostname}catch(r){a="Third-party Script"}}if(!a){let r=(i.textContent||"").toLowerCase();if(r){for(let{patterns:d,name:g}of o)if(d.some(P=>r.includes(P))){a=g;break}}a=a||"Inline Script"}a&&!n.has(a)&&(n.add(a),t.push({name:s,provider:a,origin:l?"Third-party":"First-party"}))}),t}detectLanguage(){return(navigator.language||navigator.userLanguage||"en").split("-")[0]}escapeHtml(e){let t=document.createElement("div");return t.textContent=e,t.innerHTML}},w=class{constructor(){this.detectedCookies=new Map,this.debugMode=!1,this.cookiePatterns=this.initializeCookiePatterns(),this.currentDomain=typeof window!="undefined"?window.location.hostname:null,typeof document!="undefined"&&this.performInitialScan()}performInitialScan(){let e=this.scanCookies();for(let t of e)this.detectedCookies.set(t.name,t);console.log(`[CookieScanner] Initial scan complete: ${e.length} cookies detected`)}initializeCookiePatterns(){return{_ga:"analytics",_gid:"analytics",_gat:"analytics",_gat_gtag:"analytics",_gac:"analytics",_gcl_au:"analytics",_dc_gtm_:"analytics",__utma:"analytics",__utmb:"analytics",__utmc:"analytics",__utmt:"analytics",__utmz:"analytics",_hjid:"analytics",_hjFirstSeen:"analytics",_hjIncludedInPageviewSample:"analytics",_hjIncludedInSessionSample:"analytics",_hjAbsoluteSessionInProgress:"analytics",_hjSession:"analytics",_hjSessionUser_:"analytics",_clck:"analytics",_clsk:"analytics",CLID:"analytics",SM:"analytics",ai_session:"analytics",ai_user:"analytics",_fbp:"marketing",_fbc:"marketing",fr:"marketing",_fr:"marketing",tr:"marketing",_gcl_aw:"marketing",_gcl_dc:"marketing",IDE:"marketing",DSID:"marketing",test_cookie:"marketing","__Secure-3PAPISID":"marketing","__Secure-3PSID":"marketing","__Secure-3PSIDTS":"marketing","__Secure-BUCKET":"marketing","Secure-ENID":"marketing",NID:"marketing",AEC:"marketing",APISID:"marketing",SAPISID:"marketing",HSID:"marketing",SID:"marketing",SSID:"marketing",SIDCC:"marketing",SEARCH_SAMESITE:"marketing",ADS_VISITOR_ID:"marketing",ps_l:"marketing",S:"marketing",_ttp:"marketing",_ttp_pixel:"marketing",__ttd:"marketing",YSC:"marketing",VISITOR_INFO1_LIVE:"marketing",MUID:"marketing",ANONCHK:"marketing",wd:"marketing",lang:"preferences",language:"preferences",i18n:"preferences",locale:"preferences",theme:"preferences",timezone:"preferences",currency:"preferences",PHPSESSID:"necessary",JSESSIONID:"necessary",ASPSESSIONID:"necessary","ASP.NET_SessionId":"necessary",".ASPXANONYMOUS":"necessary","ASP.NET_ID":"necessary",".ARRAffinity":"necessary",ARRAffinity:"necessary",ARRAffinitySameSite:"necessary",session:"necessary",csrf:"necessary","XSRF-TOKEN":"necessary",__cfduid:"necessary",__cf_bm:"necessary","rs-cmp-consent":"necessary",cityidc_:"necessary",CNC_PSIC:"necessary",SRM_B:"necessary"}}categorizeCookie(e){if(this.cookiePatterns[e])return this.cookiePatterns[e];for(let[t,n]of Object.entries(this.cookiePatterns))if(e.startsWith(t))return n;return"necessary"}isFirstPartyCookie(e){if(!this.currentDomain||!e)return!0;let t=e.startsWith(".")?e.substring(1):e,n=this.currentDomain;return n===t||n.endsWith("."+t)||t.endsWith("."+n)}scanCookies(){if(typeof document=="undefined")return[];let e=[],t=document.cookie.split(";");for(let n of t){let o=n.trim();if(!o)continue;let[i,...l]=o.split("="),a=l.join("=");if(!i)continue;let s=this.categorizeCookie(i),r=this.isFirstPartyCookie(this.currentDomain),d={name:i,value:a,domain:this.currentDomain||"",path:"/",secure:null,httpOnly:!1,sameSite:"Lax",expires:null,isFirstParty:r,category:s,detectedAt:Date.now()};e.push(d)}return e}scanOnConsentChange(){console.log("[CookieScanner] Scanning cookies after consent change...");let e=this.scanCookies();for(let t of e){let n=this.detectedCookies.get(t.name);n?n.value!==t.value&&(this.detectedCookies.set(t.name,t),console.log(`[CookieScanner] Cookie updated: ${t.name}`)):(this.detectedCookies.set(t.name,t),console.log(`[CookieScanner] New cookie detected: ${t.name} (${t.category})`))}}setDebugMode(e){this.debugMode=e,console.log(`[CookieScanner] Debug mode ${e?"enabled":"disabled"}`)}getAllCookies(){return Array.from(this.detectedCookies.values())}getCookiesByCategory(e){return this.getAllCookies().filter(t=>t.category===e)}getCookieReport(){let e=this.getAllCookies();return{timestamp:new Date().toISOString(),domain:this.currentDomain,totalCookies:e.length,firstPartyCookies:e.filter(n=>n.isFirstParty).length,thirdPartyCookies:e.filter(n=>!n.isFirstParty).length,categories:{necessary:this.getCookiesByCategory("necessary").length,analytics:this.getCookiesByCategory("analytics").length,marketing:this.getCookiesByCategory("marketing").length,preferences:this.getCookiesByCategory("preferences").length},cookies:e.map(n=>({name:n.name,domain:n.domain,category:n.category,isFirstParty:n.isFirstParty,detectedAt:n.detectedAt}))}}sendReportToBackend(e,t){return m(this,null,function*(){try{let n=this.getCookieReport();yield fetch(`${e}/v1/cookies/scan`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(p({siteId:t},n))}),console.log("[CookieScanner] Report sent to backend")}catch(n){console.error("[CookieScanner] Failed to send report:",n)}})}deleteCookiesByCategory(e){let t=this.scanCookies(),n=0;for(let o of t)e.includes(o.category)&&(this.deleteCookie(o.name),n++,this.detectedCookies.delete(o.name));n>0&&console.log(`[CookieScanner] Attempted to delete ${n} cookies from categories: ${e.join(", ")}`)}deleteCookie(e){if(document.cookie=`${e}=; max-age=0; path=/`,this.currentDomain){document.cookie=`${e}=; max-age=0; path=/; domain=${this.currentDomain}`,document.cookie=`${e}=; max-age=0; path=/; domain=.${this.currentDomain}`;let t=this.currentDomain.split(".");if(t.length>2){let n=t.slice(1).join(".");document.cookie=`${e}=; max-age=0; path=/; domain=${n}`,document.cookie=`${e}=; max-age=0; path=/; domain=.${n}`}}}clear(){this.detectedCookies.clear()}},_=class{constructor(){this.consentStorage=new k,this.consentManager=new S(this.consentStorage),this.cookieScanner=new w,this.scriptBlocker=new C(this.consentManager),this.bannerUI=new v(this.consentManager,this.cookieScanner,this.scriptBlocker),this.googleConsentMode=new x(this.consentManager),this.config=null,this.siteId=null,this.debugMode=!1,this.reopenButton=null}init(e=null){return m(this,null,function*(){try{if(this.siteId=this.getSiteIdFromScript(),e)this.config=this.mergeWithDefaults(e);else if(this.siteId)try{this.config=yield this.loadConfig(this.siteId)}catch(n){console.warn("[RS-CMP] Failed to load config from API, using default configuration:",n.message),this.config=this.getDefaultConfig()}else this.config=this.getDefaultConfig();let t=this.consentStorage.getConsent();t?(this.applyConsent(t.categories,!1),this.showReopenButton()):(this.scriptBlocker.blockScripts(),this.bannerUI.show(this.config)),this.consentManager.on("consentUpdated",n=>{this.applyConsent(n,!0)}),this.consentManager.on("bannerClosed",()=>{this.showReopenButton()})}catch(t){console.error("[RS-CMP] Initialization error:",t)}})}getSiteIdFromScript(){let e=document.querySelectorAll("script[data-site-id]");return e.length>0?e[0].getAttribute("data-site-id"):null}shouldAutoInit(){let e=document.querySelectorAll("script[data-site-id]");return e.length>0?e[0].getAttribute("data-auto-init")!=="false":!0}loadConfig(e){return m(this,null,function*(){let n=`${this.getApiUrl()}/v1/site/${e}/config`,o=yield fetch(n);if(!o.ok)throw new Error(`Failed to load config from ${n}: ${o.status}`);return o.json()})}getApiUrl(){let e=document.querySelectorAll("script[data-site-id]");if(e.length>0){let t=e[0].getAttribute("data-api-url");if(t)return t}return"https://api.rs-cmp.com"}applyConsent(e,t=!1){let n=[];e.analytics||n.push("analytics"),e.marketing||n.push("marketing"),e.preferences||n.push("preferences"),n.length>0&&this.cookieScanner.deleteCookiesByCategory(n),this.scriptBlocker.unblockScripts(e),this.googleConsentMode.update(e),this.cookieScanner.scanOnConsentChange(),this.siteId&&this.config&&this.sendConsentToBackend(e),t&&console.log("[RS-CMP] Page reload requested but skipped - using hot-swapping instead")}showPreferences(){this.config&&this.bannerUI.show(this.config)}resetConsent(){this.consentStorage.clearConsent(),this.scriptBlocker.blockScripts(),this.showPreferences()}getConsent(){return this.consentManager.getConsent()}enableDebug(){this.debugMode=!0,console.log("[RS-CMP] Debug mode enabled")}disableDebug(){this.debugMode=!1}log(...e){this.debugMode&&console.log("[RS-CMP]",...e)}setDebugMode(e){this.debugMode=e,this.cookieScanner.setDebugMode(e),console.log(`[RS-CMP] Debug mode ${e?"enabled":"disabled"}`)}handleNewCookie(e){if(this.log("New cookie detected:",e.name,"Category:",e.category),this.siteId&&this.config){let t=Date.now();(!this._lastCookieReport||t-this._lastCookieReport>1e4)&&(this._lastCookieReport=t,this.sendCookieReportToBackend())}}getCookieReport(){return this.cookieScanner.getCookieReport()}getDetectedCookies(){return this.cookieScanner.getAllCookies()}sendCookieReportToBackend(){return m(this,null,function*(){if(!(!this.siteId||!this.config))try{let e=this.getApiUrl();yield this.cookieScanner.sendReportToBackend(e,this.siteId)}catch(e){console.error("[RS-CMP] Failed to send cookie report:",e)}})}getStatus(){return{initialized:!!this.config,siteId:this.siteId,consent:this.consentManager.getConsent(),blockedScripts:this.scriptBlocker.blockedScripts.length,bannerVisible:!!this.bannerUI.bannerElement,detectedCookies:this.cookieScanner.getAllCookies().length,cookieCategories:{necessary:this.cookieScanner.getCookiesByCategory("necessary").length,analytics:this.cookieScanner.getCookiesByCategory("analytics").length,marketing:this.cookieScanner.getCookiesByCategory("marketing").length,preferences:this.cookieScanner.getCookiesByCategory("preferences").length}}}testConsentMode(){typeof window.gtag=="function"?(console.log("[RS-CMP] Testing Google Consent Mode..."),window.gtag("get","G-XXXXXX","consent",e=>{console.log("[RS-CMP] Current consent state:",e)})):console.warn("[RS-CMP] gtag not available")}getDefaultConfig(){return{siteId:"default",siteName:"Website",domain:window.location.hostname,policyVersion:"1.0",banner:{position:"bottom",layout:"bar",primaryColor:"#0084ff",backgroundColor:"#ffffff",textColor:"#000000",buttonTextColor:"#ffffff",showLogo:!1},categories:[{id:"necessary",name:"Necessary",description:"Required for site functionality",required:!0,enabled:!0},{id:"analytics",name:"Analytics",description:"Help us improve",required:!1,enabled:!1},{id:"marketing",name:"Marketing",description:"Personalized ads",required:!1,enabled:!1},{id:"preferences",name:"Preferences",description:"Remember your choices",required:!1,enabled:!1}],translations:{it:{title:"Rispettiamo la tua privacy",description:"Utilizziamo i cookie per finalit\xE0 tecniche e, con il tuo consenso, anche per le finalit\xE0 di esperienza, analisi e marketing come specificato nella cookie policy. Puoi liberamente prestare, rifiutare o revocare il tuo consenso, in qualsiasi momento, accedendo al pannello delle preferenze. Il rifiuto del consenso pu\xF2 rendere non disponibili le relative funzioni.",acceptAll:"Accetta tutto",rejectAll:"Rifiuta tutto",customize:"Personalizza",save:"Salva preferenze",close:"Chiudi",categories:{necessary:{name:"Necessari",description:"Cookie essenziali per il funzionamento del sito"},analytics:{name:"Analitici",description:"Statistiche di utilizzo per migliorare il sito"},marketing:{name:"Marketing",description:"Cookie pubblicitari per annunci personalizzati"},preferences:{name:"Preferenze",description:"Le tue impostazioni personalizzate"}}},en:{title:"We respect your privacy",description:"We use cookies to improve your experience.",acceptAll:"Accept All",rejectAll:"Reject All",customize:"Customize",save:"Save Preferences",close:"Close",categories:{necessary:{name:"Necessary",description:"Essential cookies"},analytics:{name:"Analytics",description:"Usage statistics"},marketing:{name:"Marketing",description:"Advertising cookies"},preferences:{name:"Preferences",description:"Your settings"}}}}}}mergeWithDefaults(e){let t=this.getDefaultConfig();return M(p(p({},t),e),{banner:p(p({},t.banner),e.banner||{}),categories:e.categories||t.categories,translations:p(p({},t.translations),e.translations||{})})}showReopenButton(){if(this.reopenButton)return;let e=document.createElement("button");if(e.id="rs-cmp-reopen-btn",e.setAttribute("aria-label","Privacy Settings"),e.title="Privacy Settings",e.innerHTML=`
      <svg width="24" height="24" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
        <path d="M12 1L3 5v6c0 5.55 3.84 10.74 9 12 5.16-1.26 9-6.45 9-12V5l-9-4zm0 10.99h7c-.53 4.12-3.28 7.79-7 8.94V12H5V6.3l7-3.11v8.8z" fill="currentColor"/>
      </svg>
    `,!document.getElementById("rs-cmp-reopen-styles")){let t=document.createElement("style");t.id="rs-cmp-reopen-styles",t.textContent=`
        #rs-cmp-reopen-btn {
          position: fixed;
          bottom: 20px;
          left: 20px;
          width: 48px;
          height: 48px;
          border-radius: 50%;
          background: #0084ff;
          color: white;
          border: none;
          box-shadow: 0 2px 8px rgba(0, 0, 0, 0.2);
          cursor: pointer;
          z-index: 999998;
          display: flex;
          align-items: center;
          justify-content: center;
          transition: all 0.3s ease;
        }
        
        #rs-cmp-reopen-btn:hover {
          transform: scale(1.1);
          box-shadow: 0 4px 12px rgba(0, 0, 0, 0.3);
        }
        
        #rs-cmp-reopen-btn:focus {
          outline: 2px solid #0084ff;
          outline-offset: 2px;
        }
        
        @media (max-width: 768px) {
          #rs-cmp-reopen-btn {
            bottom: 15px;
            left: 15px;
            width: 44px;
            height: 44px;
          }
        }
      `;let n=b();n&&t.setAttribute("nonce",n),document.head.appendChild(t)}e.addEventListener("click",()=>{this.showPreferences()}),document.body.appendChild(e),this.reopenButton=e}hideReopenButton(){this.reopenButton&&(this.reopenButton.remove(),this.reopenButton=null)}sendConsentToBackend(e){return m(this,null,function*(){try{let t=this.getApiUrl();yield fetch(`${t}/v1/consent`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({siteId:this.siteId,categories:e,timestamp:new Date().toISOString(),version:this.config?this.config.policyVersion:"1.0"})})}catch(t){console.error("[RS-CMP] Failed to send consent:",t)}})}},u=new _;typeof window!="undefined"&&(document.readyState,u.scriptBlocker.blockScripts(),window.RSCMP=u,u.shouldAutoInit()?(console.log("[RS-CMP] Auto-initializing..."),u.init().catch(e=>{console.error("[RS-CMP] Auto-initialization failed:",e)})):console.log("[RS-CMP] Manual init required. Call window.RSCMP.init() to initialize."));typeof h!="undefined"&&typeof h.exports!="undefined"&&(h.exports=u)});return B();})();
