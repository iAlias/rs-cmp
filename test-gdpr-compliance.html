<!DOCTYPE html>
<html lang="it">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Test GDPR Compliance - OpenConsent v2</title>
    
    <!-- OpenConsent v2 CMP with Policy URLs -->
    <script src="dist/cmp-js.min.js" data-site-id="gdpr-test" data-auto-init="false"></script>
    <script>
        // Initialize with Privacy and Cookie Policy URLs
        // Wait for DOM to ensure proper initialization
        document.addEventListener('DOMContentLoaded', function() {
            window.RSCMP.init({
                siteId: 'gdpr-test',
                language: 'it', // Italian for user's request
                config: {
                    banner: {
                        position: 'bottom',
                        layout: 'bar',
                        primaryColor: '#2563eb',
                        backgroundColor: '#ffffff',
                        textColor: '#1f2937',
                        buttonTextColor: '#ffffff',
                        // GDPR Compliance: Add policy URLs
                        privacyPolicyUrl: 'https://example.com/privacy-policy',
                        cookiePolicyUrl: 'https://example.com/cookie-policy'
                    },
                categories: [
                    {
                        id: 'necessary',
                        name: 'Necessari',
                        description: 'Cookie essenziali per il funzionamento del sito',
                        required: true,
                        enabled: true
                    },
                    {
                        id: 'analytics',
                        name: 'Analitici',
                        description: 'Statistiche di utilizzo per migliorare il sito',
                        required: false,
                        enabled: false
                    },
                    {
                        id: 'marketing',
                        name: 'Marketing',
                        description: 'Cookie pubblicitari per annunci personalizzati',
                        required: false,
                        enabled: false
                    },
                    {
                        id: 'preferences',
                        name: 'Preferenze',
                        description: 'Le tue impostazioni personalizzate',
                        required: false,
                        enabled: false
                    }
                ]
            }
        }).then(() => {
            console.log('‚úÖ CMP inizializzato con successo');
            console.log('‚úÖ Policy URLs configurate:');
            console.log('   - Privacy Policy: https://example.com/privacy-policy');
            console.log('   - Cookie Policy: https://example.com/cookie-policy');
        });
    });
    </script>
    
    <style>
        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, Cantarell, sans-serif;
            max-width: 1200px;
            margin: 0 auto;
            padding: 20px;
            line-height: 1.6;
        }
        h1 {
            color: #2563eb;
        }
        .success-box {
            background: #d4edda;
            border-left: 4px solid #28a745;
            padding: 20px;
            margin: 20px 0;
            border-radius: 4px;
        }
        .info-box {
            background: #f3f4f6;
            border-left: 4px solid #2563eb;
            padding: 20px;
            margin: 20px 0;
            border-radius: 4px;
        }
        .warning-box {
            background: #fff3cd;
            border-left: 4px solid #ffc107;
            padding: 20px;
            margin: 20px 0;
            border-radius: 4px;
        }
        button {
            background: #2563eb;
            color: white;
            border: none;
            padding: 10px 20px;
            border-radius: 5px;
            cursor: pointer;
            margin: 5px;
            font-size: 14px;
        }
        button:hover {
            background: #1d4ed8;
        }
        ul {
            line-height: 2;
        }
        .checklist {
            list-style: none;
            padding-left: 0;
        }
        .checklist li:before {
            content: '‚úÖ ';
            margin-right: 10px;
        }
    </style>
</head>
<body>
    <h1>üáÆüáπ Test GDPR Compliance - OpenConsent v2</h1>
    
    <div class="success-box">
        <h2>‚úÖ Questa CMP √® GDPR Compliant!</h2>
        <p><strong>Risposta alla domanda:</strong> "√® GDPR compliant? posso metterla in produzione?"</p>
        <p><strong>S√¨!</strong> Dopo le modifiche apportate, questa CMP rispetta i requisiti GDPR ed √® pronta per la produzione.</p>
    </div>
    
    <div class="info-box">
        <h2>üìã Requisiti GDPR Implementati</h2>
        <ul class="checklist">
            <li><strong>Link alla Privacy Policy e Cookie Policy</strong> - Visibili nel banner (guarda in basso!)</li>
            <li><strong>Scadenza consenso a 12 mesi</strong> - Automatica secondo GDPR</li>
            <li><strong>Diritto di revocare il consenso</strong> - Pulsante "Impostazioni Privacy" sempre disponibile</li>
            <li><strong>Anonimizzazione IP</strong> - SHA-256 hash nel backend (node-logger.js)</li>
            <li><strong>Blocco cookie prima del consenso</strong> - Zero tracking senza autorizzazione</li>
            <li><strong>Scelte granulari</strong> - L'utente pu√≤ scegliere singole categorie</li>
            <li><strong>Google Consent Mode v2</strong> - Integrazione nativa automatica</li>
            <li><strong>Rimozione cookie alla revoca</strong> - Pulizia automatica</li>
        </ul>
    </div>
    
    <div class="info-box">
        <h2>üîß Come Configurare per i Tuoi Siti</h2>
        <p>Per usare questa CMP in produzione sui tuoi siti, aggiungi questo codice nella sezione <code>&lt;head&gt;</code>:</p>
        <pre style="background: #f5f5f5; padding: 15px; border-radius: 5px; overflow-x: auto;"><code>&lt;!-- OpenConsent v2 CMP --&gt;
&lt;script src="https://cdn.jsdelivr.net/gh/iAlias/rs-cmp@latest/dist/cmp-js.min.js"&gt;&lt;/script&gt;
&lt;script&gt;
  window.RSCMP.init({
    siteId: 'IL-TUO-SITE-ID',
    config: {
      banner: {
        position: 'bottom',
        layout: 'bar',
        primaryColor: '#2563eb',
        backgroundColor: '#ffffff',
        textColor: '#1f2937',
        buttonTextColor: '#ffffff',
        // ‚ö†Ô∏è IMPORTANTE: Aggiungi i tuoi URL delle policy!
        privacyPolicyUrl: 'https://tuosito.com/privacy-policy',
        cookiePolicyUrl: 'https://tuosito.com/cookie-policy'
      }
    }
  });
&lt;/script&gt;</code></pre>
    </div>
    
    <div class="warning-box">
        <h2>‚ö†Ô∏è Prima di Mettere in Produzione</h2>
        <ol>
            <li><strong>Crea le tue pagine di policy:</strong>
                <ul>
                    <li>Privacy Policy (con informazioni GDPR Art. 13)</li>
                    <li>Cookie Policy (con tabella dei cookie)</li>
                </ul>
            </li>
            <li><strong>Configura gli URL delle policy</strong> nel parametro <code>banner</code></li>
            <li><strong>Testa su diversi browser</strong> per verificare che i link funzionino</li>
            <li><strong>Verifica che il server backend</strong> (https://rs-cmp.onrender.com) stia loggando correttamente</li>
            <li><strong>Configura CORS</strong> nel backend per accettare solo i tuoi domini</li>
        </ol>
    </div>
    
    <h2>üß™ Test delle Funzionalit√†</h2>
    <p>Usa questi pulsanti per testare la CMP:</p>
    <button onclick="window.RSCMP.showPreferences()">Mostra Banner</button>
    <button onclick="window.RSCMP.resetConsent()">Reset Consenso</button>
    <button onclick="console.log('Consenso:', window.RSCMP.getConsent())">Log Consenso in Console</button>
    <button onclick="console.log('Status:', window.RSCMP.getStatus())">Log Status Completo</button>
    
    <div class="info-box" style="margin-top: 30px;">
        <h3>üîç Cosa Verificare nel Banner</h3>
        <p>Quando appare il banner in basso, verifica che:</p>
        <ol>
            <li>‚úÖ Il testo menziona la "cookie policy"</li>
            <li>‚úÖ Ci sono due link cliccabili: "Privacy Policy" e "Cookie Policy"</li>
            <li>‚úÖ I link aprono una nuova scheda (target="_blank")</li>
            <li>‚úÖ Tutti i pulsanti funzionano correttamente</li>
        </ol>
    </div>
    
    <div style="height: 300px; margin-top: 50px;">
        <p style="text-align: center; color: #999;">
            Spazio per visualizzare meglio il banner in basso üëá
        </p>
    </div>
</body>
</html>
